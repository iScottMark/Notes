# 7.面向对象高级编程

## 7.0.简介

OOP 中最基础的 3 个特征：

- 数据封装
- 继承
- 多态

在 Python 中，OOP 还有很多高级特性，允许我们写出非常强大的功能。

- 多重继承
- 定制类
- 元类
- ……

<br></br>

## 7.1. 使用 `__slots__`

§ 6.5.实例属性和类属性中已经讲了，可以给实例自由绑定属性，同样我们也可以给实例绑定方法：

``` bash
>>> def set_age(self, age):  # 定义一个函数作为实例方法
...     self.age = age
...
>>> from types import MethodType
>>> s.set_age = MethodType(set_age, s)  # 给实例绑定一个方法
>>> s.set_age(25)  # 调用实例方法
>>> s.age  # 测试结果
25
```

**但是，给一个实例绑定的方法，对另一个实例是不起作用的：**

``` bash
>>> s2 = Student() # 创建新的实例
>>> s2.set_age(25) # 尝试调用方法
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'Student' object has no attribute 'set_age'
```

为了给所有实例都绑定方法，可以给 class 绑定方法：

``` bash
>>> def set_score(self, score):
...     self.score = score
...
>>> Student.set_score = set_score
```

给 class 绑定方法后，所有实例均可调用：

``` bash
>>> s.set_score(100)
>>> s.score
100
>>> s2.set_score(99)
>>> s2.score
99
```

::: tip
通常情况下，上面的 `set_score` 方法可以直接定义在 class 中，但动态绑定允许我们在程序运行的过程中动态地给 class 加上功能，这在静态语言中很难实现。
:::

**使用 `__slots__` 限制可绑定的实例属性**

``` python
class Student(object):
    __slots__ = ('name', 'age')  # 用tuple定义允许绑定的属性名称
```

``` bash
>>> s = Student()  # 创建新的实例
>>> s.name = 'Michael'  # 绑定属性'name'
>>> s.age = 25  # 绑定属性'age'
>>> s.score = 99  # 绑定属性'score'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'Student' object has no attribute 'score'
```

使用 `__slots__` 要注意，`__slots__` 定义的属性仅对当前类实例起作用，对继承的子类是不起作用的：

``` bash
>>> class GraduateStudent(Student):
...     pass
...
>>> g = GraduateStudent()
>>> g.score = 9999
```

除非在子类中也定义 `__slots__`，这样，子类实例允许定义的属性就是自身的 `__slots__` 加上父类的 `__slots__`。

**小结**

绑定属性和方法

| | 类 | 实例 | 备注 |
|--|-- |--    |--   |
|<b>属性</b>| 在类内部定义| 外部自由绑定 | 若绑定的属性相同，实例属性会屏蔽类属性|
|<b>方法</b>| 可在外部传入函数方法，但不建议这么做，通常定义在类内部 | 使用 `types.MethodType` | 类方法可通用；但实例绑定的方法，对另一个实例**不**起作用 |

<br></br>

## 7.2.使用 `@property` 

